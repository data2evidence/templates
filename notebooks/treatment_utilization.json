{
  "id": "3551aead-8c9b-4029-9864-e8a1697a8f48",
  "name": "TreatmentUtilization",
  "notebookContent": "---\nipynb_metadata:\n  kernelspec:\n    display_name: semantic_search_venv\n    language: python\n    name: python3\n  language_info:\n    name: python\n    version: 3.8.20\njupystar:\n  version: 0.2.1\n---\n# %% [markdown]\n\n## Treatment Pathways Network Study Using Strategus\n# %% [markdown]\n## Step 1 - Import the necessary libraries\n\n# %% [jupyter]\n# import libraries\nlibrary(rD2E)\nlibrary(Strategus)\nlibrary(dplyr)\n# %% [markdown]\n#### Step 2 - Cohort definition loading\n# %% [jupyter]\ncohorts_set <- c(52, 51, 50, 49)\ncohortDefinitionSet <- rD2E::get_cohort_definition_set(cohorts_set)\n# %% [markdown]\n#### Step 3 - Define the network study components\n# %% [jupyter]\n# Study period\nstudyStartDate <- \"19001201\"\nstudyEndDate <- \"20231231\"\n\n# Assume target cohort is for depression\ntargetCohortId <- 52  # actual depression cohort ID\n\n# Event cohorts: SSRI, SNRI, TCA, bupropion, esketamine\neventCohortIds <- c(51, 50, 49)  \n\n# Shared resources\ncgModuleSettingsCreator <- CohortGeneratorModule$new()\ncohortDefinitionShared <- cgModuleSettingsCreator$createCohortSharedResourceSpecifications(cohortDefinitionSet)\ncohortGeneratorModuleSpecifications <- cgModuleSettingsCreator$createModuleSpecifications(generateStats = TRUE)\n# %% [jupyter]\n# TreatmentPatterns module setup\ntpModuleSettingsCreator <- TreatmentPatternsModule$new()\n\ntreatmentPatternsSpecifications <- tpModuleSettingsCreator$createModuleSpecifications(\n  cohorts = data.frame(\n                cohortId = c(52, 51, 50, 49),\n                cohortName = c(\"depression\", \"SSRI\", \"SNRI\", \"BUPROPION\"),\n                type = c(\"target\", \"event\", \"event\", \"event\")\n            )\n)\n# %% [jupyter]\n# Create analysis spec\nanalysisSpecifications <- Strategus::createEmptyAnalysisSpecificiations() |>\n  Strategus::addSharedResources(cohortDefinitionShared) |>\n  Strategus::addModuleSpecifications(cohortGeneratorModuleSpecifications) |>\n  Strategus::addModuleSpecifications(treatmentPatternsSpecifications)\n# %% [markdown]\n#### Step 4 - Execute the Strategus study\n# %% [jupyter]\nstudy_name <- \"treatment_pathways_study\"  # Unique study name\noptions <- create_options(upload_results=TRUE, study_id = study_name) # set a study_id with a unique id\nrD2E::run_strategus_flow(analysisSpecification = analysisSpecifications, options = options)",
  "isShared": true,
  "datasetId": "67f4015c-04f0-4a92-939b-20c361c2e50a"
}