{
  "name": "dataload_vocab",
  "description": "Load vocabulary data into the database",
  "edges": [
    {
      "id": "d5191dc1-edb8-4664-a4a4-7ce06d2eff9b",
      "source": "f88a9d25-2259-459b-ba7d-ccbca3b7ae67",
      "target": "54eba542-c666-45ea-935f-253145baf7d3"
    },
    {
      "id": "reactflow__edge-54eba542-c666-45ea-935f-253145baf7d3source_54eba542-c666-45ea-935f-253145baf7d3_any-b2687498-5be3-4edc-88cf-9ad41e600602target_b2687498-5be3-4edc-88cf-9ad41e600602_any",
      "source": "54eba542-c666-45ea-935f-253145baf7d3",
      "target": "b2687498-5be3-4edc-88cf-9ad41e600602",
      "sourceHandle": "source_54eba542-c666-45ea-935f-253145baf7d3_any",
      "targetHandle": "target_b2687498-5be3-4edc-88cf-9ad41e600602_any"
    },
    {
      "id": "reactflow__edge-f88a9d25-2259-459b-ba7d-ccbca3b7ae67source_f88a9d25-2259-459b-ba7d-ccbca3b7ae67_any-b2687498-5be3-4edc-88cf-9ad41e600602target_b2687498-5be3-4edc-88cf-9ad41e600602_any",
      "source": "f88a9d25-2259-459b-ba7d-ccbca3b7ae67",
      "target": "b2687498-5be3-4edc-88cf-9ad41e600602",
      "sourceHandle": "source_f88a9d25-2259-459b-ba7d-ccbca3b7ae67_any",
      "targetHandle": "target_b2687498-5be3-4edc-88cf-9ad41e600602_any"
    },
    {
      "id": "reactflow__edge-6d1c43a3-610d-4241-aa35-c5922667be65source_6d1c43a3-610d-4241-aa35-c5922667be65_any-b2687498-5be3-4edc-88cf-9ad41e600602target_b2687498-5be3-4edc-88cf-9ad41e600602_any",
      "source": "6d1c43a3-610d-4241-aa35-c5922667be65",
      "target": "b2687498-5be3-4edc-88cf-9ad41e600602",
      "sourceHandle": "source_6d1c43a3-610d-4241-aa35-c5922667be65_any",
      "targetHandle": "target_b2687498-5be3-4edc-88cf-9ad41e600602_any"
    },
    {
      "id": "4345d58b-e9b7-45b7-b3df-6345e341fe56",
      "source": "b2687498-5be3-4edc-88cf-9ad41e600602",
      "target": "63ea4f7c-9165-4943-92c0-e6fc1eeb7951"
    },
    {
      "id": "reactflow__edge-b2687498-5be3-4edc-88cf-9ad41e600602source_b2687498-5be3-4edc-88cf-9ad41e600602_object-72d2f629-6211-4650-bdc5-89567094108ctarget_72d2f629-6211-4650-bdc5-89567094108c_object",
      "source": "b2687498-5be3-4edc-88cf-9ad41e600602",
      "target": "72d2f629-6211-4650-bdc5-89567094108c",
      "sourceHandle": "source_b2687498-5be3-4edc-88cf-9ad41e600602_object",
      "targetHandle": "target_72d2f629-6211-4650-bdc5-89567094108c_object"
    },
    {
      "id": "e44d95e0-9a25-4a18-b6c0-e1ff90ce533e",
      "source": "b2687498-5be3-4edc-88cf-9ad41e600602",
      "target": "d09c87d4-6299-465d-8b14-4c90a53d68de"
    },
    {
      "id": "reactflow__edge-63ea4f7c-9165-4943-92c0-e6fc1eeb7951source_63ea4f7c-9165-4943-92c0-e6fc1eeb7951_dataframe-ece6447a-3e2b-47ab-a046-b4a42e0df72btarget_ece6447a-3e2b-47ab-a046-b4a42e0df72b_dataframe",
      "source": "63ea4f7c-9165-4943-92c0-e6fc1eeb7951",
      "target": "ece6447a-3e2b-47ab-a046-b4a42e0df72b",
      "sourceHandle": "source_63ea4f7c-9165-4943-92c0-e6fc1eeb7951_dataframe",
      "targetHandle": "target_ece6447a-3e2b-47ab-a046-b4a42e0df72b_dataframe"
    },
    {
      "id": "reactflow__edge-72d2f629-6211-4650-bdc5-89567094108csource_72d2f629-6211-4650-bdc5-89567094108c_dataframe-dc16e130-4891-4ac9-884e-0256ffc75ed9target_dc16e130-4891-4ac9-884e-0256ffc75ed9_dataframe",
      "source": "72d2f629-6211-4650-bdc5-89567094108c",
      "target": "dc16e130-4891-4ac9-884e-0256ffc75ed9",
      "sourceHandle": "source_72d2f629-6211-4650-bdc5-89567094108c_dataframe",
      "targetHandle": "target_dc16e130-4891-4ac9-884e-0256ffc75ed9_dataframe"
    },
    {
      "id": "reactflow__edge-d09c87d4-6299-465d-8b14-4c90a53d68desource_d09c87d4-6299-465d-8b14-4c90a53d68de_dataframe-56ad0e7c-d2dd-4db8-ad45-ee0efa654e6btarget_56ad0e7c-d2dd-4db8-ad45-ee0efa654e6b_dataframe",
      "source": "d09c87d4-6299-465d-8b14-4c90a53d68de",
      "target": "56ad0e7c-d2dd-4db8-ad45-ee0efa654e6b",
      "sourceHandle": "source_d09c87d4-6299-465d-8b14-4c90a53d68de_dataframe",
      "targetHandle": "target_56ad0e7c-d2dd-4db8-ad45-ee0efa654e6b_dataframe"
    },
    {
      "id": "reactflow__edge-962eeb15-c355-4805-9c8e-7e64621be306source_962eeb15-c355-4805-9c8e-7e64621be306_any-bc5898f4-0a47-4d62-bdf6-754c6df6d242target_bc5898f4-0a47-4d62-bdf6-754c6df6d242_dataframe",
      "source": "962eeb15-c355-4805-9c8e-7e64621be306",
      "target": "bc5898f4-0a47-4d62-bdf6-754c6df6d242",
      "sourceHandle": "source_962eeb15-c355-4805-9c8e-7e64621be306_any",
      "targetHandle": "target_bc5898f4-0a47-4d62-bdf6-754c6df6d242_dataframe"
    },
    {
      "id": "reactflow__edge-8615cd55-cdf7-40d9-ad6e-a3f520afdbbbsource_8615cd55-cdf7-40d9-ad6e-a3f520afdbbb_any-3f3a795d-4f4c-4e17-ab50-60b620e95643target_3f3a795d-4f4c-4e17-ab50-60b620e95643_dataframe",
      "source": "8615cd55-cdf7-40d9-ad6e-a3f520afdbbb",
      "target": "3f3a795d-4f4c-4e17-ab50-60b620e95643",
      "sourceHandle": "source_8615cd55-cdf7-40d9-ad6e-a3f520afdbbb_any",
      "targetHandle": "target_3f3a795d-4f4c-4e17-ab50-60b620e95643_dataframe"
    },
    {
      "id": "reactflow__edge-bf69b569-78f3-48b5-82c7-2b0418d01dbcsource_bf69b569-78f3-48b5-82c7-2b0418d01dbc_any-1f883cf7-16aa-4e9f-a29e-763d2aaaf617target_1f883cf7-16aa-4e9f-a29e-763d2aaaf617_dataframe",
      "source": "bf69b569-78f3-48b5-82c7-2b0418d01dbc",
      "target": "1f883cf7-16aa-4e9f-a29e-763d2aaaf617",
      "sourceHandle": "source_bf69b569-78f3-48b5-82c7-2b0418d01dbc_any",
      "targetHandle": "target_1f883cf7-16aa-4e9f-a29e-763d2aaaf617_dataframe"
    },
    {
      "id": "f8053a8c-a3e3-4075-8f42-c8bbbac8bcab",
      "source": "bf69b569-78f3-48b5-82c7-2b0418d01dbc",
      "target": "4cf26301-2c73-41b0-af71-285fb26211e5"
    },
    {
      "id": "reactflow__edge-4cf26301-2c73-41b0-af71-285fb26211e5source_4cf26301-2c73-41b0-af71-285fb26211e5_any-9fe077a7-68a4-429d-a608-3ff1ab6e2df9target_9fe077a7-68a4-429d-a608-3ff1ab6e2df9_dataframe",
      "source": "4cf26301-2c73-41b0-af71-285fb26211e5",
      "target": "9fe077a7-68a4-429d-a608-3ff1ab6e2df9",
      "sourceHandle": "source_4cf26301-2c73-41b0-af71-285fb26211e5_any",
      "targetHandle": "target_9fe077a7-68a4-429d-a608-3ff1ab6e2df9_dataframe"
    }
  ],
  "nodes": [
    {
      "id": "8615cd55-cdf7-40d9-ad6e-a3f520afdbbb",
      "data": {
        "file": "CONCEPT_SYNONYM.csv",
        "name": "concept_synonym_csv",
        "delimiter": "/t",
        "description": "Describe the task of node 8615cd55"
      },
      "type": "csv_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": -620,
        "y": 30
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": -620,
        "y": 30
      }
    },
    {
      "id": "3f3a795d-4f4c-4e17-ab50-60b620e95643",
      "data": {
        "name": "write_to_concept_synonym",
        "database": "alpdev_pg",
        "dataframe": [
          "concept_synonym_csv"
        ],
        "schemaname": "cdmvocab",
        "dbtablename": "concept_synonym",
        "description": "Describe the task of node 3f3a795d"
      },
      "type": "db_writer_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": -80,
        "y": 30
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": -80,
        "y": 30
      }
    },
    {
      "id": "6d1c43a3-610d-4241-aa35-c5922667be65",
      "data": {
        "file": "DRUG_STRENGTH.csv",
        "name": "drug_strength_csv",
        "delimiter": "/t",
        "description": "Describe the task of node 6d1c43a3"
      },
      "type": "csv_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": -630,
        "y": -320
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": -630,
        "y": -320
      }
    },
    {
      "id": "ece6447a-3e2b-47ab-a046-b4a42e0df72b",
      "data": {
        "name": "write_to_drug_strength",
        "database": "alpdev_pg",
        "dataframe": [
          "transformed_drug_strength"
        ],
        "schemaname": "cdmvocab",
        "dbtablename": "drug_strength",
        "description": "Describe the task of node ece6447a"
      },
      "type": "db_writer_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": 1130,
        "y": -330
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": 1130,
        "y": -330
      }
    },
    {
      "id": "f88a9d25-2259-459b-ba7d-ccbca3b7ae67",
      "data": {
        "file": "concept_mini.csv",
        "name": "concept_csv",
        "delimiter": "/t",
        "description": "Describe the task of node f88a9d25"
      },
      "type": "csv_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": -640,
        "y": -680
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": -640,
        "y": -680
      }
    },
    {
      "id": "54eba542-c666-45ea-935f-253145baf7d3",
      "data": {
        "file": "concept_relationship_mini.csv",
        "name": "concept_relationship_csv",
        "delimiter": "/t",
        "description": "Describe the task of node 54eba542"
      },
      "type": "csv_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": -640,
        "y": -1000
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": -640,
        "y": -1000
      }
    },
    {
      "id": "b2687498-5be3-4edc-88cf-9ad41e600602",
      "data": {
        "name": "transform_df",
        "description": "Describe the task of node b2687498",
        "python_code": "import pandas as pd\nimport numpy as np\n\ndef exec(myinput):\n\n  original_dfs = {}\n  transformed_dfs = {}\n  original_dfs[\"drug_strength\"] = myinput[\"drug_strength_csv\"].result\n  original_dfs[\"concept\"] = myinput[\"concept_csv\"].result\n  original_dfs[\"concept_relationship\"] = myinput[\"concept_relationship_csv\"].result\n\n  for table, df in original_dfs.items():\n    df[\"valid_start_date\"] = pd.to_datetime(df[\"valid_start_date\"].astype(str))\n    df[\"valid_end_date\"] =  pd.to_datetime(df[\"valid_end_date\"].astype(str))\n\n    if table == \"drug_strength\":\n      # Integer columns use pd.NA\n      df[\"amount_unit_concept_id\"].replace('', pd.NA, inplace=True)\n      df[\"box_size\"].replace('', pd.NA, inplace=True)\n      df[\"numerator_unit_concept_id\"].replace('', pd.NA, inplace=True)\n      df[\"denominator_unit_concept_id\"].replace('', pd.NA, inplace=True)\n      \n      # Float Columns use np.nan\n      df[\"amount_value\"].replace('', np.nan, inplace=True)\n      df[\"numerator_value\"].replace('', np.nan, inplace=True)\n      df[\"denominator_value\"].replace('', np.nan, inplace=True)\n      \n      # Convert to integer\n      df[\"amount_unit_concept_id\"] = pd.to_numeric(df[\"amount_unit_concept_id\"], errors=\"coerce\").astype('Int64')\n      df[\"box_size\"] = pd.to_numeric(df[\"box_size\"], errors=\"coerce\").astype('Int64')\n      df[\"numerator_unit_concept_id\"] = pd.to_numeric(df[\"numerator_unit_concept_id\"], errors=\"coerce\").astype('Int64')\n      df[\"denominator_unit_concept_id\"] = pd.to_numeric(df[\"denominator_unit_concept_id\"], errors=\"coerce\").astype('Int64')\n      \n      # Convert to float\n      df[\"amount_value\"] = pd.to_numeric(df[\"amount_value\"], errors=\"coerce\").astype('float64')\n      df[\"numerator_value\"] = pd.to_numeric(df[\"numerator_value\"], errors=\"coerce\").astype('float64')\n      df[\"denominator_value\"] = pd.to_numeric(df[\"denominator_value\"], errors=\"coerce\").astype('float64')\n\n    df = df.replace(\"N/A\", \"N/A\")\n    df = df.rename(columns=str.lower)\n\n    transformed_dfs[table] = df\n  return transformed_dfs"
      },
      "type": "python_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": 30,
        "y": -680
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": 30,
        "y": -680
      }
    },
    {
      "id": "63ea4f7c-9165-4943-92c0-e6fc1eeb7951",
      "data": {
        "map": {
          "py2table_node_0": [
            "transform_df",
            "drug_strength"
          ]
        },
        "name": "transformed_drug_strength",
        "uiMap": {
          "path": "$.drug_strength",
          "source": "transform_df.script_node"
        },
        "description": "Describe the task of node 63ea4f7c"
      },
      "type": "py2table_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": 560,
        "y": -330
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": 560,
        "y": -330
      }
    },
    {
      "id": "72d2f629-6211-4650-bdc5-89567094108c",
      "data": {
        "map": {
          "py2table_node_1": [
            "transform_df",
            "concept"
          ]
        },
        "name": "transformed_concept",
        "uiMap": {
          "path": "$.concept",
          "source": "transform_df.script_node"
        },
        "description": "Describe the task of node 72d2f629"
      },
      "type": "py2table_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": 570,
        "y": -680
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": 570,
        "y": -680
      }
    },
    {
      "id": "d09c87d4-6299-465d-8b14-4c90a53d68de",
      "data": {
        "map": {
          "py2table_node_2": [
            "transform_df",
            "concept_relationship"
          ]
        },
        "name": "transformed_concept_relationship",
        "uiMap": {
          "path": "$.concept_relationship",
          "source": "transform_df.script_node"
        },
        "description": "Describe the task of node d09c87d4"
      },
      "type": "py2table_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": 570,
        "y": -1030
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": 570,
        "y": -1030
      }
    },
    {
      "id": "dc16e130-4891-4ac9-884e-0256ffc75ed9",
      "data": {
        "name": "write_to_concept",
        "database": "alpdev_pg",
        "dataframe": [
          "transformed_concept"
        ],
        "schemaname": "cdmvocab",
        "dbtablename": "concept",
        "description": "Describe the task of node dc16e130"
      },
      "type": "db_writer_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": 1120,
        "y": -680
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": 1120,
        "y": -680
      }
    },
    {
      "id": "56ad0e7c-d2dd-4db8-ad45-ee0efa654e6b",
      "data": {
        "name": "write_to_concept_relationship",
        "database": "alpdev_pg",
        "dataframe": [
          "transformed_concept_relationship"
        ],
        "schemaname": "cdmvocab",
        "dbtablename": "concept_relationship",
        "description": "Describe the task of node 56ad0e7c"
      },
      "type": "db_writer_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": 1120,
        "y": -1030
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": 1120,
        "y": -1030
      }
    },
    {
      "id": "bf69b569-78f3-48b5-82c7-2b0418d01dbc",
      "data": {
        "file": "VOCABULARY.csv",
        "name": "vocabulary_csv",
        "delimiter": "/t",
        "description": "Describe the task of node bf69b569"
      },
      "type": "csv_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": -620,
        "y": 310
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": -620,
        "y": 310
      }
    },
    {
      "id": "1f883cf7-16aa-4e9f-a29e-763d2aaaf617",
      "data": {
        "name": "write_to_vocabulary",
        "database": "alpdev_pg",
        "dataframe": [
          "vocabulary_csv"
        ],
        "schemaname": "cdmvocab",
        "dbtablename": "vocabulary",
        "description": "Describe the task of node 1f883cf7"
      },
      "type": "db_writer_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": -80,
        "y": 310
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": -80,
        "y": 310
      }
    },
    {
      "id": "9fe077a7-68a4-429d-a608-3ff1ab6e2df9",
      "data": {
        "name": "write_to_relationship",
        "database": "alpdev_pg",
        "dataframe": [
          "relationship_csv"
        ],
        "schemaname": "cdmvocab",
        "dbtablename": "relationship",
        "description": "Describe the task of node 9fe077a7"
      },
      "type": "db_writer_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": 1130,
        "y": 30
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": 1130,
        "y": 30
      }
    },
    {
      "id": "962eeb15-c355-4805-9c8e-7e64621be306",
      "data": {
        "file": "concept_ancestor_mini.csv",
        "name": "concept_ancestor_csv",
        "delimiter": "/t",
        "description": "Describe the task of node 962eeb15"
      },
      "type": "csv_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": 590,
        "y": 300
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": 590,
        "y": 300
      }
    },
    {
      "id": "bc5898f4-0a47-4d62-bdf6-754c6df6d242",
      "data": {
        "name": "write_to_concept_ancestor",
        "database": "alpdev_pg",
        "dataframe": [
          "concept_ancestor_csv"
        ],
        "schemaname": "cdmvocab",
        "dbtablename": "concept_ancestor",
        "description": "Describe the task of node bc5898f4"
      },
      "type": "db_writer_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": 1140,
        "y": 300
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": 1140,
        "y": 300
      }
    },
    {
      "id": "4cf26301-2c73-41b0-af71-285fb26211e5",
      "data": {
        "file": "RELATIONSHIP.csv",
        "name": "relationship_csv",
        "delimiter": "/t",
        "description": "Describe the task of node 4cf26301"
      },
      "type": "csv_node",
      "width": 350,
      "height": 210,
      "dragging": false,
      "position": {
        "x": 580,
        "y": 30
      },
      "selected": false,
      "dragHandle": "",
      "sourcePosition": "right",
      "targetPosition": "left",
      "positionAbsolute": {
        "x": 580,
        "y": 30
      }
    }
  ]
}