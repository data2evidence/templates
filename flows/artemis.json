{
  "id": "b1ab8cb2-cbb9-4886-a4ed-69b55589fef8",
  "name": "Artemis",
  "flow": {
    "edges": [
      {
        "id": "reactflow__edge-51cba923-4db7-4804-a46e-a47a63fc31a0source_51cba923-4db7-4804-a46e-a47a63fc31a0_object-89361be9-e4b7-46cd-9f0e-581c26b3b3dctarget_89361be9-e4b7-46cd-9f0e-581c26b3b3dc_any",
        "source": "51cba923-4db7-4804-a46e-a47a63fc31a0",
        "target": "89361be9-e4b7-46cd-9f0e-581c26b3b3dc",
        "sourceHandle": "source_51cba923-4db7-4804-a46e-a47a63fc31a0_object",
        "targetHandle": "target_89361be9-e4b7-46cd-9f0e-581c26b3b3dc_any"
      }
    ],
    "nodes": [
      {
        "id": "51cba923-4db7-4804-a46e-a47a63fc31a0",
        "type": "python_node",
        "width": 350,
        "height": 210,
        "dragging": false,
        "position": { "x": -420, "y": 80 },
        "selected": false,
        "dragHandle": "",
        "sourcePosition": "right",
        "targetPosition": "left",
        "positionAbsolute": { "x": -420, "y": 80 },
        "data": {
          "name": "README",
          "error": false,
          "result": "{\n  \"error\": false,\n  \"errorMessage\": null,\n  \"nodeName\": \"README\",\n  \"length\": null,\n  \"type\": \"<class 'NoneType'>\"\n}",
          "description": "Describe the ARTEMIS flow and supported conditions.",
          "python_code": "def exec(myinput):\n  \"\"\"\n  ARTEMIS provides an interface for utilizing a modified Temporal Smith-Waterman (TSW) algorithm.\n  Configure this template via flow.variables (connection + schemas + condition + params).\n\n  Supported conditions list:\n  (see original README list)\n  \"\"\"\n",
          "errorMessage": null
        }
      },
      {
        "id": "89361be9-e4b7-46cd-9f0e-581c26b3b3dc",
        "type": "r_node",
        "width": 354,
        "height": 214,
        "dragging": false,
        "position": { "x": 40, "y": 100 },
        "selected": false,
        "dragHandle": "",
        "sourcePosition": "right",
        "targetPosition": "left",
        "positionAbsolute": { "x": 40, "y": 100 },
        "data": {
          "name": "Artemis",
          "error": false,
          "r_code": "library(ARTEMIS)\n\nexec <- function(myinput) {\n    # Connection details via template variables\n    connectionDetails <- DatabaseConnector::createConnectionDetails(\n      dbms = \"{{dbms}}\",\n      server = \"{{server}}\",\n      user = \"{{db_user}}\",\n      password = \"{{db_password}}\",\n      port = \"{{db_port}}\",\n      pathToDriver = \"{{pathToDriver}}\",\n      extraSettings = \"{{extraSettings}}\"\n    )\n\n    # Inputs via template variables\n    json <- loadCohort()\n    name <- \"{{cohort_name}}\"\n\n    validdrugs <- loadDrugs()\n    regimens <- loadRegimens(condition = \"{{condition}}\")\n    regGroups <- loadGroups()\n\n    cdmSchema   <- \"{{cdmSchema}}\"      # input schema\n    writeSchema <- \"{{writeSchema}}\"    # output schema\n\n    # Main\n    con_df <- getConDF(\n      connectionDetails = connectionDetails,\n      json = json,\n      name = name,\n      cdmSchema = cdmSchema,\n      writeSchema = writeSchema\n    )\n\n    stringDF <- stringDF_from_cdm(\n      con_df = con_df,\n      writeOut = FALSE,\n      validDrugs = validdrugs\n    )\n\n    output_all <- stringDF %>% generateRawAlignments(\n      regimens = regimens,\n      g = {{g}},\n      Tfac = {{Tfac}},\n      method = \"{{method}}\",\n      verbose = {{verbose}}\n    )\n\n    processedAll <- output_all %>% processAlignments(\n      regimenCombine = {{regimenCombine}},\n      regimens = regimens\n    )\n\n    processedEras <- processedAll %>% calculateEras()\n\n    regStats <- processedEras %>% generateRegimenStats()\n\n    # OUTPUT\n    writeOutputs(\n      output_all,\n      processedAll = processedAll,\n      processedEras = processedEras,\n      connectionDetails = connectionDetails,\n      cdmSchema = cdmSchema,\n      regGroups = regGroups,\n      regStats = regStats,\n      stringDF = stringDF,\n      con_df = con_df\n    )\n}\n",
          "result": "{\n  \"error\": false,\n  \"errorMessage\": null,\n  \"nodeName\": \"Artemis\"\n}",
          "description": "Run ARTEMIS using variable-configured DB connection, schemas, condition, and parameters.",
          "errorMessage": null
        }
      }
    ],
    "variables": [
      { "key": "dbms", "value": "postgresql" },
      { "key": "server", "value": "localhost/postgres" },
      { "key": "db_user", "value": "postgres" },
      { "key": "db_password", "value": "yourpassword" },
      { "key": "db_port", "value": "15432" },
      { "key": "pathToDriver", "value": "~/.jdbc" },
      { "key": "extraSettings", "value": "sslmode=disable" },
      { "key": "cohort_name", "value": "lungcancer" },
      { "key": "condition", "value": "lungCancer" },
      { "key": "cdmSchema", "value": "test_lungCancer" },
      { "key": "writeSchema", "value": "demo_cdm_results" },
      { "key": "g", "value": 0.4 },
      { "key": "Tfac", "value": 0.4 },
      { "key": "method", "value": "PropDiff" },
      { "key": "verbose", "value": 0 },
      { "key": "regimenCombine", "value": 28 }
    ],
    "importLibs": []
  }
}
